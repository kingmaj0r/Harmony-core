{"version":3,"file":"harmony.mjs","sources":["../src/harmony.ts"],"sourcesContent":["import { Plugin, UserConfig, ResolvedConfig, ViteDevServer } from 'vite';\nimport fs = require('fs');\nimport path = require('path');\n\nexport function harmonyCore(): Plugin {\n  return {\n    name: 'harmony-core',\n    configResolved(resolvedConfig: ResolvedConfig): void {\n      const updatedConfig: ResolvedConfig = {\n        ...resolvedConfig,\n        build: {\n          outDir: './storage/dist',\n          rollupOptions: {\n            input: './src/index.tsx',\n            output: {\n              filename: 'vendor.[contenthash].js',\n            },\n          }\n        }\n      };\n\n      Object.assign(resolvedConfig, updatedConfig);\n    },\n    configureServer(server: ViteDevServer) {\n      return () => {\n        const index = path.join(__dirname, '../dist/index.html');\n\n        server.middlewares.use((req, res, next) => {\n          if (req.url === '/index.html') {\n            try {\n              const indexContent = fs.readFileSync(index, 'utf-8');\n              res.setHeader('Content-Type', 'text/html');\n              res.end(indexContent);\n            } catch (err) {\n              console.error('Error reading index.html:', err);\n              next(err);\n            }\n          } else {\n            next();\n          }\n        });\n      };\n    },\n  }\n}"],"names":["fs","path","harmonyCore","resolvedConfig","updatedConfig","server","index","req","res","next","indexContent","err"],"mappings":"AACA,MAAOA,IAAK,QAAQ,IAAA,GACbC,IAAO,QAAQ,MAAA;AAEf,SAASC,IAAsB;AAC7B,SAAA;AAAA,IACL,MAAM;AAAA,IACN,eAAeC,GAAsC;AACnD,YAAMC,IAAgC;AAAA,QACpC,GAAGD;AAAA,QACH,OAAO;AAAA,UACL,QAAQ;AAAA,UACR,eAAe;AAAA,YACb,OAAO;AAAA,YACP,QAAQ;AAAA,cACN,UAAU;AAAA,YACZ;AAAA,UACF;AAAA,QACF;AAAA,MAAA;AAGK,aAAA,OAAOA,GAAgBC,CAAa;AAAA,IAC7C;AAAA,IACA,gBAAgBC,GAAuB;AACrC,aAAO,MAAM;AACX,cAAMC,IAAQL,EAAK,KAAK,WAAW,oBAAoB;AAEvD,QAAAI,EAAO,YAAY,IAAI,CAACE,GAAKC,GAAKC,MAAS;AACrC,cAAAF,EAAI,QAAQ;AACV,gBAAA;AACF,oBAAMG,IAAeV,EAAG,aAAaM,GAAO,OAAO;AAC/C,cAAAE,EAAA,UAAU,gBAAgB,WAAW,GACzCA,EAAI,IAAIE,CAAY;AAAA,qBACbC,GAAK;AACJ,sBAAA,MAAM,6BAA6BA,CAAG,GAC9CF,EAAKE,CAAG;AAAA,YACV;AAAA;AAEK,YAAAF;QACP,CACD;AAAA,MAAA;AAAA,IAEL;AAAA,EAAA;AAEJ;"}