{"version":3,"file":"harmony.js","sources":["../src/harmony.ts"],"sourcesContent":["import { Plugin, UserConfig, ResolvedConfig, ViteDevServer } from 'vite';\nimport fs = require('fs');\nimport path = require('path');\n\nexport function harmonyCore(): Plugin {\n  return {\n    name: 'harmony-core',\n    configResolved(resolvedConfig: ResolvedConfig): void {\n      const updatedConfig: ResolvedConfig = {\n        ...resolvedConfig,\n        build: {\n          outDir: './storage/dist',\n          rollupOptions: {\n            input: './src/index.tsx',\n            output: {\n              filename: 'vendor.[contenthash].js',\n            },\n          }\n        }\n      };\n\n      Object.assign(resolvedConfig, updatedConfig);\n    },\n    configureServer(server: ViteDevServer) {\n      return () => {\n        const index = path.join(__dirname, '../dist/index.html');\n\n        server.middlewares.use((req, res, next) => {\n          if (req.url === '/index.html') {\n            try {\n              const indexContent = fs.readFileSync(index, 'utf-8');\n              res.setHeader('Content-Type', 'text/html');\n              res.end(indexContent);\n            } catch (err) {\n              console.error('Error reading index.html:', err);\n              next(err);\n            }\n          } else {\n            next();\n          }\n        });\n      };\n    },\n  }\n}"],"names":["fs","path","harmonyCore","resolvedConfig","updatedConfig","server","index","req","res","next","indexContent","err"],"mappings":"gFACA,MAAOA,EAAK,QAAQ,IAAA,EACbC,EAAO,QAAQ,MAAA,EAEf,SAASC,GAAsB,CAC7B,MAAA,CACL,KAAM,eACN,eAAeC,EAAsC,CACnD,MAAMC,EAAgC,CACpC,GAAGD,EACH,MAAO,CACL,OAAQ,iBACR,cAAe,CACb,MAAO,kBACP,OAAQ,CACN,SAAU,yBACZ,CACF,CACF,CAAA,EAGK,OAAA,OAAOA,EAAgBC,CAAa,CAC7C,EACA,gBAAgBC,EAAuB,CACrC,MAAO,IAAM,CACX,MAAMC,EAAQL,EAAK,KAAK,UAAW,oBAAoB,EAEvDI,EAAO,YAAY,IAAI,CAACE,EAAKC,EAAKC,IAAS,CACrC,GAAAF,EAAI,MAAQ,cACV,GAAA,CACF,MAAMG,EAAeV,EAAG,aAAaM,EAAO,OAAO,EAC/CE,EAAA,UAAU,eAAgB,WAAW,EACzCA,EAAI,IAAIE,CAAY,QACbC,EAAK,CACJ,QAAA,MAAM,4BAA6BA,CAAG,EAC9CF,EAAKE,CAAG,CACV,MAEKF,GACP,CACD,CAAA,CAEL,CAAA,CAEJ"}